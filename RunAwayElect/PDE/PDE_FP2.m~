%This code presents the analytical solution of the FP
Q = 1;
ExactF = @(x,t)(Q*exp(-x.^2));
source = @(x,t)(x-x);

psi = @(x)(1./x.^2.*(erf(x)-2*x/sqrt(pi).*exp(-x.^2)));

Ca = 1;
Cf = 1;

PDE.term1.Opt = 'Grad';
PDE.term1.FunCoef = FunCoef1;%@(x)(x == 0).*(0)+(x>0).*( x.*(1./x.^2.*(erf(x)-2*x/sqrt(pi).*exp(-x.^2))) );
PDE.term1.Coef =  Cf;

PDE.term2.Opt = 'Diff';
PDE.term2.FunCoef = FunCoef3;%@(x)(x == 0).*(0)+(x>0).*( (2*x.^2.*(1./x.^2.*(erf(x)-2*x/sqrt(pi).*exp(-x.^2)))) );
PDE.term2.Coef = Ca;

function y = FunCoef1(x)
if abs(x)<1e-5
    y = 0;
else
    y = x.*(1./x.^2.*(erf(x)-2*x/sqrt(pi).*exp(-x.^2)));
end

function y = FunCoef2(x)
if abs(x)<1e-5
    y = 0;
else
    y = x.*(1./x.^2.*(erf(x)-2*x/sqrt(pi).*exp(-x.^2)));
end
FunCoef2 = @(x)-(2*exp(-x.^2)/sqrt(pi)-(erf(x)-2*x.*exp(-x.^2)/sqrt(pi))./x.^3);

function y = FunCoef3(x)
if abs(x)<1e-5
    y = 0;
else
    y = (2*x.^2.*(1./x.^2.*(erf(x)-2*x/sqrt(pi).*exp(-x.^2))));
end

end
