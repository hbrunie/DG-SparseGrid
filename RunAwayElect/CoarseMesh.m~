function [Hash,IHash,FineIndex] = CoarseMesh(Hash,IHash,Deg,MarkedIndex,FineIndex)


index = unique(ceil(( MarkedIndex )/Deg));
NewHash = Hash;
NewIHash = IHash;

count = size(IHash,2);
delem = 0;
for i = 1:size(index,1)
    %     ll = IHash{ceil(index(i)/Deg)}
    ll = IHash{index(i)};
    lev_loc = ll(1);
    cel_loc = ll(2);
    id_loc = ll(3);
    
    
    key = [lev_loc,cel_loc];
    
    NewHash = rmfield(NewHash,sprintf('i%g_',key));
    NewIHash(index(i)-delem) = [];
    
    if lev_loc>1
    ix = find(FineIndex == id_loc);
    FineIndex(ix) = [];
    % check about children
    key1 = [lev_loc,2*ceil(cel_loc/2)];
    key2 = [lev_loc,2*ceil(cel_loc/2)+1];
        if isfield(Hash,sprintf('i%g_',key)) == 0 && isfield(Hash,sprintf('i%g_',key)) == 0
            % no children then put mom to fineindex
            key = [lev_loc-1,ceil(cel_loc/2)];
            lr = Hash.(name);
            NewFineIndex = lr;
        end
    end
    
    count = index(i)-delem;
    for j = count : size(NewIHash,2)
        ll2 = NewIHash{j};
        key = [ll2(1) ll2(2)];
        NewHash = setfield(NewHash,sprintf('i%g_',key),count);
        count = count+1;
    end
%     NewHash
    delem = delem + 1;
end

Hash = NewHash;
IHash = NewIHash;


% FineGrid = EndGrid+1 : Deg*count;